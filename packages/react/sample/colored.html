<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>UpSet</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/d3"></script>
    <script src="./upset.js"></script>
    <script>
      function mergeColors(colors) {
        if (colors.length === 0) {
          return undefined;
        }
        if (colors.length === 1) {
          return colors[0];
        }
        const cc = colors.reduce(
          (acc, d) => {
            const c = d3.lab(d || 'transparent');
            return {
              l: acc.l + c.l,
              a: acc.a + c.a,
              b: acc.b + c.b,
            };
          },
          { l: 0, a: 0, b: 0 }
        );
        return d3.lab(cc.l / colors.length, cc.a / colors.length, cc.b / colors.length).toString();
      }
      loadUpSetJS().then(({ UpSetJS, render, elems }) => {
        const sets = UpSetJS.extractSets(elems);
        sets[0].color = 'red';
        sets[1].color = 'steelblue';
        sets[2].color = 'green';
        sets[3].color = 'blue';
        sets[4].color = 'cyan';
        sets[5].color = 'yellow';

        const props = {
          sets,
          hasSelectionOpacity: 0.4,
          width: 1200,
          height: 500,
          selection,
          combinations: {
            mergeColors,
          },
          onHover: (s) => {
            props.selection = s;
            rerender();
          },
        };
        function rerender() {
          render(props);
        }
        rerender();
      });
    </script>
  </body>
</html>
